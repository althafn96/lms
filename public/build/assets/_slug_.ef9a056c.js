import{u as q,U as M,y as _,N as j,a0 as L,k as P,a7 as A,g as Q,r as z,i as G,l as K,m as e,O as $,Y as x,q as i,a8 as Y,n as E,P as b,Q as k,R as I,s as H,x as w}from"./vendor.9ac200cc.js";import{u as J,K as W,a as X}from"./app.52277fe1.js";import{v as Z}from"./useValidator.4107c1a7.js";import"./sweetalert2.1b53689f.js";import{C as ee}from"./ckeditor.80e0daed.js";import{d as ae}from"./getInstructor.5f18a601.js";import{s as te}from"./vue-multiselect.esm.f7127d48.js";import{d as ie}from"./getLocationsToSelect.34aa23e1.js";import"./Bootstrap5.88c59918.js";var h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateInstructor"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bio"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"display_picture"}},type:{kind:"NamedType",name:{kind:"Name",value:"Upload"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contact_number"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"address"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"user"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstructorUserMorphOne"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locations"}},type:{kind:"NamedType",name:{kind:"Name",value:"LocationBelongsToMany"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateInstructor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"first_name"},value:{kind:"Variable",name:{kind:"Name",value:"first_name"}}},{kind:"ObjectField",name:{kind:"Name",value:"last_name"},value:{kind:"Variable",name:{kind:"Name",value:"last_name"}}},{kind:"ObjectField",name:{kind:"Name",value:"bio"},value:{kind:"Variable",name:{kind:"Name",value:"bio"}}},{kind:"ObjectField",name:{kind:"Name",value:"display_picture"},value:{kind:"Variable",name:{kind:"Name",value:"display_picture"}}},{kind:"ObjectField",name:{kind:"Name",value:"contact_number"},value:{kind:"Variable",name:{kind:"Name",value:"contact_number"}}},{kind:"ObjectField",name:{kind:"Name",value:"address"},value:{kind:"Variable",name:{kind:"Name",value:"address"}}},{kind:"ObjectField",name:{kind:"Name",value:"user"},value:{kind:"Variable",name:{kind:"Name",value:"user"}}},{kind:"ObjectField",name:{kind:"Name",value:"locations"},value:{kind:"Variable",name:{kind:"Name",value:"locations"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"full_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:688}};h.loc.source={body:`mutation updateInstructor (\r
    $id: ID!,\r
    $first_name: String!,\r
    $last_name: String!,\r
    $bio: String,\r
    $display_picture: Upload,\r
    $contact_number: String,\r
    $address: String,\r
    $user: InstructorUserMorphOne,\r
    $locations: LocationBelongsToMany\r
) {\r
    updateInstructor (\r
        id: $id,\r
        input: {\r
            first_name: $first_name,\r
            last_name: $last_name,\r
            bio: $bio,\r
            display_picture: $display_picture,\r
            contact_number: $contact_number,\r
            address: $address,\r
            user: $user,\r
            locations: $locations\r
        }\r
    ) {\r
        full_name\r
        slug\r
    }\r
}\r
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function g(s,l){if(s.kind==="FragmentSpread")l.add(s.name.value);else if(s.kind==="VariableDefinition"){var o=s.type;o.kind==="NamedType"&&l.add(o.name.value)}s.selectionSet&&s.selectionSet.selections.forEach(function(d){g(d,l)}),s.variableDefinitions&&s.variableDefinitions.forEach(function(d){g(d,l)}),s.definitions&&s.definitions.forEach(function(d){g(d,l)})}var V={};(function(){h.definitions.forEach(function(l){if(l.name){var o=new Set;g(l,o),V[l.name.value]=o}})})();function T(s,l){for(var o=0;o<s.definitions.length;o++){var d=s.definitions[o];if(d.name&&d.name.value==l)return d}}function ne(s,l){var o={kind:s.kind,definitions:[T(s,l)]};s.hasOwnProperty("loc")&&(o.loc=s.loc);var d=V[l]||new Set,v=new Set,m=new Set;for(d.forEach(function(r){m.add(r)});m.size>0;){var u=m;m=new Set,u.forEach(function(r){if(!v.has(r)){v.add(r);var a=V[r]||new Set;a.forEach(function(y){m.add(y)})}})}return v.forEach(function(r){var a=T(s,r);a&&o.definitions.push(a)}),o}ne(h,"updateInstructor");const se={class:"content d-flex flex-column flex-column-fluid",id:"kt_content"},le={class:"container-xxl",id:"kt_content_container"},oe=["onSubmit"],de={class:"d-flex flex-column gap-7 gap-lg-10 w-100 w-lg-300px mb-7 me-lg-10"},re={class:"card card-flush py-4"},ce=e("div",{class:"card-header"},[e("div",{class:"card-title"},[e("h2",null,"Display Picture")])],-1),ue={class:"card-body text-center pt-0"},me={class:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"change","data-bs-toggle":"tooltip",title:"Change Image"},pe=e("i",{class:"bi bi-pencil-fill fs-7"},null,-1),ve=e("span",{class:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"cancel","data-bs-toggle":"tooltip",title:"Cancel Image"},[e("i",{class:"bi bi-x fs-2"})],-1),be=e("span",{class:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"remove","data-bs-toggle":"tooltip",title:"Remove Image"},[e("i",{class:"bi bi-x fs-2"})],-1),fe=e("div",{class:"text-muted fs-7"},"Set the display picture. Only *.png, *.jpg and *.jpeg image files are accepted",-1),_e={class:"card card-flush py-4"},ke=e("div",{class:"card-header"},[e("div",{class:"card-title"},[e("h2",null,"Institutions")])],-1),he={class:"card-body text-center pt-0"},ge={class:"mb-10 fv-row"},ye={class:"d-flex flex-column flex-row-fluid gap-7 gap-lg-10"},Ne={class:"d-flex flex-column gap-7 gap-lg-10"},xe=H('<ul class="nav nav-custom nav-tabs nav-line-tabs nav-line-tabs-2x border-0 fs-4 fw-bold mb-n2"><li class="nav-item"><a class="nav-link text-active-primary pb-4 active" data-bs-toggle="tab" href="#general">General</a></li><li class="nav-item"><a class="nav-link text-active-primary pb-4" data-bs-toggle="tab" href="#credentials">Credentials</a></li></ul>',1),we={class:"tab-content"},Ve={class:"tab-pane fade show active",id:"general",role:"tab-panel"},Se={class:"d-flex flex-column gap-7 gap-lg-10"},De={class:"card card-flush py-4"},je=e("div",{class:"card-header"},[e("div",{class:"card-title"},[e("h2",null,"General")])],-1),$e={class:"card-body pt-0"},Ee={class:"mb-10 fv-row"},Ie=e("label",{class:"required form-label"},"First Name",-1),Te={class:"mb-10 fv-row"},Oe=e("label",{class:"required form-label"},"Last Name",-1),Ce={class:"mb-10 fv-row"},Fe=e("label",{class:"form-label"},"Bio",-1),Ue={class:"mb-10 fv-row d-flex flex-column"},Be=e("label",{class:"form-label"},"Status",-1),Re={class:"btn-group w-50","data-kt-buttons":"true","data-kt-buttons-target":"[data-kt-button]"},qe=["checked"],Me=w(" Enabled "),Le=["checked"],Pe=w(" Disabled "),Ae={class:"tab-pane fade",id:"credentials",role:"tab-panel"},Qe={class:"d-flex flex-column gap-7 gap-lg-10"},ze={class:"card card-flush py-4"},Ge=e("div",{class:"card-header"},[e("div",{class:"card-title"},[e("h2",null,"Credentials")])],-1),Ke={class:"card-body pt-0"},Ye={class:"mb-10 fv-row"},He=e("label",{class:"required form-label"},"Email",-1),Je={class:"mb-10 fv-row"},We=e("label",{class:"form-label"},"Password",-1),Xe={class:"d-flex justify-content-end"},Ze=e("span",{class:"indicator-label"},"Save Changes",-1),ea=e("span",{class:"indicator-progress"},[w("Please wait... "),e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"})],-1),aa=[Ze,ea],pa={setup(s){const l=J();l.title="Update Instructor",l.breadcrumbs=[{link:"/dashboard",title:"Dashboard"},{link:"/instructors",title:"Instructors"},{link:"",title:"Update Instructor"}];const o=q(),{result:d,loading:v}=M(ae,{slug:o.currentRoute.value.params.slug});let m=_(null),u=_(null),r=_(null),a=j({id:"",first_name:"",last_name:"",bio:"",contact_number:"",address:"",display_picture:null,selected_locations:[],locations:{sync:[]},user:{update:{id:"",email:"",password:"",status:1}}}),y=ee,O={};const{resolveClient:C}=L(),F=C();let N=_(null),c=j({}),S=_([]);const{mutate:U,onDone:ta,onError:ia}=P(h),B=()=>{r.validate().then(async function(p){if(p=="Valid"){a.locations.sync=[],a.selected_locations.length&&a.selected_locations.forEach(function(t,f){a.locations.sync.push(t.id)}),u.value.setAttribute("data-kt-indicator","on"),u.value.disabled=!0;try{const t=await U(a,{context:{hasUpload:!0}});alert("instructor updated successfully"),u.value.removeAttribute("data-kt-indicator"),u.value.disabled=!1}catch{alert("error occurred. please try again later."),u.value.removeAttribute("data-kt-indicator"),u.value.disabled=!1}}else alert("Sorry, looks like there are some errors detected, please try again.")})},D=(p,t,f)=>{if(t=="display_picture")if(f=="set"){let n=new Blob(N.value.files,{type:"image/*"});n.name=N.value.files[0].name,a.display_picture=n}else a.display_picture=null},R=async()=>{const{data:p,loading:t,fetch:f}=await F.query({query:ie},{fetchPolicy:"network-only"});S.value=p.locations.data.map(function(n){return{id:n.id,name:n.name}})};return A(()=>{if(d.value){if(!d.value.instructor)o.push("/instructors");else if(c=d.value.instructor,a.id=c.id,a.first_name=c.first_name,a.last_name=c.last_name,a.bio=c.bio,a.user.update.status=c.user.status?1:0,a.user.update.id=c.user.id,a.user.update.email=c.user.email,c.locations.length){let p=[];c.locations.forEach(function(t){p.push({id:t.id,name:t.name})}),a.selected_locations=p}}}),Q(()=>{r=Z(m.value,{first_name:{validators:{notEmpty:{message:"first name is required"}}},last_name:{validators:{notEmpty:{message:"last name is required"}}},email:{validators:{notEmpty:{message:"email is required"}}}}),W.init(),X.initButtons()}),(p,t)=>{const f=z("ckeditor");return G(),K("div",se,[e("div",le,[e("form",{onSubmit:$(B,["prevent"]),ref_key:"form",ref:m,class:"form fv-plugins-bootstrap5 fv-plugins-framework d-flex flex-column flex-lg-row"},[e("div",de,[e("div",re,[ce,e("div",ue,[e("div",{class:x([{"image-input-empty":!i(v)&&!i(d).instructor.display_picture!=""},"image-input image-input-outline mb-3"]),"data-kt-image-input":"true",style:{"background-image":"url(/media/svg/files/blank-image.svg)"}},[e("div",{class:"image-input-wrapper w-150px h-150px",style:Y(i(v)?"":`background-image: url(${i(d).instructor.display_picture})`)},null,4),e("label",me,[pe,e("input",{ref_key:"display_picture",ref:N,onChange:t[0]||(t[0]=n=>D(n,"display_picture","set")),type:"file",name:"display_picture",accept:".png, .jpg, .jpeg"},null,544),e("input",{type:"hidden",onClick:t[1]||(t[1]=n=>D(n,"display_picture","remove")),name:"display_picture_remove"})]),ve,be],2),fe])]),e("div",_e,[ke,e("div",he,[e("div",ge,[E(i(te),{modelValue:i(a).selected_locations,"onUpdate:modelValue":t[2]||(t[2]=n=>i(a).selected_locations=n),onSearchChange:R,"track-by":"id",label:"name","show-labels":!1,multiple:!0,"close-on-select":!1,noOptionsText:"Enter Location",placeholder:"Search a Location",options:i(S)},null,8,["modelValue","options"])])])])]),e("div",ye,[e("div",Ne,[xe,e("div",we,[e("div",Ve,[e("div",Se,[e("div",De,[je,e("div",$e,[e("div",Ee,[Ie,b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>i(a).first_name=n),type:"text",name:"first_name",class:"form-control mb-2",placeholder:"First Name"},null,512),[[k,i(a).first_name]])]),e("div",Te,[Oe,b(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>i(a).last_name=n),type:"text",name:"last_name",class:"form-control mb-2",placeholder:"Last Name"},null,512),[[k,i(a).last_name]])]),e("div",Ce,[Fe,E(f,{editor:i(y),modelValue:i(a).bio,"onUpdate:modelValue":t[5]||(t[5]=n=>i(a).bio=n),config:i(O)},null,8,["editor","modelValue","config"])]),e("div",Ue,[Be,e("div",Re,[e("label",{class:x(["btn btn-outline-secondary text-muted text-hover-white text-active-white btn-outline btn-active-success",{active:i(a).user.update.status==1}]),"data-kt-button":"true"},[b(e("input",{"onUpdate:modelValue":t[6]||(t[6]=n=>i(a).user.update.status=n),class:"btn-check",type:"radio",name:"status",value:1,checked:i(a).user.update.status==1?"checked":""},null,8,qe),[[I,i(a).user.update.status]]),Me],2),e("label",{class:x(["btn btn-outline-secondary text-muted text-hover-white text-active-white btn-outline btn-active-danger",{active:i(a).user.update.status==0}]),"data-kt-button":"true"},[b(e("input",{"onUpdate:modelValue":t[7]||(t[7]=n=>i(a).user.update.status=n),class:"btn-check",type:"radio",name:"status",value:0,checked:i(a).user.update.status==0?"checked":""},null,8,Le),[[I,i(a).user.update.status]]),Pe],2)])])])])])]),e("div",Ae,[e("div",Qe,[e("div",ze,[Ge,e("div",Ke,[e("div",Ye,[He,b(e("input",{"onUpdate:modelValue":t[8]||(t[8]=n=>i(a).user.update.email=n),type:"text",name:"email",class:"form-control mb-2",placeholder:"Email"},null,512),[[k,i(a).user.update.email]])]),e("div",Je,[We,b(e("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>i(a).user.update.password=n),type:"password",name:"password",class:"form-control mb-2",placeholder:"Password"},null,512),[[k,i(a).user.update.password]])])])])])])])]),e("div",Xe,[e("button",{onClick:t[10]||(t[10]=$(n=>i(o).go(-1),["prevent"])),id:"instructor_edit_cancel",class:"btn btn-light me-5"},"Cancel"),e("button",{ref_key:"submitButton",ref:u,type:"submit",id:"submitButton",class:"btn btn-primary"},aa,512)])])],40,oe)])])}}};export{pa as default};
