var P=Object.defineProperty,Q=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var F=(e,n,i)=>n in e?P(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i,$=(e,n)=>{for(var i in n||(n={}))z.call(n,i)&&F(e,i,n[i]);if(x)for(var i of x(n))I.call(n,i)&&F(e,i,n[i]);return e},B=(e,n)=>Q(e,M(n));import{u as G,U as K,y as p,N as T,a0 as H,k as J,a7 as W,g as X,i as Y,l as Z,m as a,O as E,n as C,q as s,P as _,Q as b,x as ee}from"./vendor.9ac200cc.js";import{u as ne,a as ae}from"./app.52277fe1.js";import{s as O}from"./vue-multiselect.esm.f7127d48.js";import{v as ie}from"./useValidator.4107c1a7.js";import"./sweetalert2.1b53689f.js";import{d as te}from"./getLocationsToSelect.34aa23e1.js";import{d as le}from"./getCoursesToSelect.708a5cf8.js";import"./Bootstrap5.88c59918.js";var h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateBatch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commences_on"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"completes_on"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enrollment_closes_on"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"course"}},type:{kind:"NamedType",name:{kind:"Name",value:"CourseBelongsTo"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"location"}},type:{kind:"NamedType",name:{kind:"Name",value:"LocationBelongsTo"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alloted_count"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateBatch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"ObjectField",name:{kind:"Name",value:"commences_on"},value:{kind:"Variable",name:{kind:"Name",value:"commences_on"}}},{kind:"ObjectField",name:{kind:"Name",value:"completes_on"},value:{kind:"Variable",name:{kind:"Name",value:"completes_on"}}},{kind:"ObjectField",name:{kind:"Name",value:"enrollment_closes_on"},value:{kind:"Variable",name:{kind:"Name",value:"enrollment_closes_on"}}},{kind:"ObjectField",name:{kind:"Name",value:"course"},value:{kind:"Variable",name:{kind:"Name",value:"course"}}},{kind:"ObjectField",name:{kind:"Name",value:"location"},value:{kind:"Variable",name:{kind:"Name",value:"location"}}},{kind:"ObjectField",name:{kind:"Name",value:"alloted_count"},value:{kind:"Variable",name:{kind:"Name",value:"alloted_count"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:636}};h.loc.source={body:`mutation updateBatch (\r
    $id: ID!,\r
    $name: String!,\r
    $commences_on: String,\r
    $completes_on: String,\r
    $enrollment_closes_on: String,\r
    $course: CourseBelongsTo,\r
    $location: LocationBelongsTo,\r
    $alloted_count: Int,\r
) {\r
    updateBatch (\r
        id: $id,\r
        input: {\r
            name: $name,\r
            commences_on: $commences_on,\r
            completes_on: $completes_on,\r
            enrollment_closes_on: $enrollment_closes_on,\r
            course: $course,\r
            location: $location,\r
            alloted_count: $alloted_count,\r
        }\r
    ) {\r
        id\r
        name\r
    }\r
}\r
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function g(e,n){if(e.kind==="FragmentSpread")n.add(e.name.value);else if(e.kind==="VariableDefinition"){var i=e.type;i.kind==="NamedType"&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(l){g(l,n)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(l){g(l,n)}),e.definitions&&e.definitions.forEach(function(l){g(l,n)})}var S={};(function(){h.definitions.forEach(function(n){if(n.name){var i=new Set;g(n,i),S[n.name.value]=i}})})();function j(e,n){for(var i=0;i<e.definitions.length;i++){var l=e.definitions[i];if(l.name&&l.name.value==n)return l}}function oe(e,n){var i={kind:e.kind,definitions:[j(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var l=S[n]||new Set,v=new Set,m=new Set;for(l.forEach(function(d){m.add(d)});m.size>0;){var u=m;m=new Set,u.forEach(function(d){if(!v.has(d)){v.add(d);var t=S[d]||new Set;t.forEach(function(r){m.add(r)})}})}return v.forEach(function(d){var t=j(e,d);t&&i.definitions.push(t)}),i}oe(h,"updateBatch");var N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getBatch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"slug"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"batch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"slug"},value:{kind:"Variable",name:{kind:"Name",value:"slug"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"course"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"location"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"commences_on"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"completes_on"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enrollment_closes_on"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"alloted_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"humanized_updated_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:365}};N.loc.source={body:`query getBatch($slug: String!) {\r
    batch(slug: $slug) {\r
        id\r
        name\r
        course {\r
            id\r
            name\r
        }\r
        location {\r
            id\r
            name\r
        }\r
        commences_on\r
        completes_on\r
        enrollment_closes_on\r
        alloted_count\r
        humanized_updated_at\r
        slug\r
    }\r
}\r
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function y(e,n){if(e.kind==="FragmentSpread")n.add(e.name.value);else if(e.kind==="VariableDefinition"){var i=e.type;i.kind==="NamedType"&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(l){y(l,n)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(l){y(l,n)}),e.definitions&&e.definitions.forEach(function(l){y(l,n)})}var V={};(function(){N.definitions.forEach(function(n){if(n.name){var i=new Set;y(n,i),V[n.name.value]=i}})})();function R(e,n){for(var i=0;i<e.definitions.length;i++){var l=e.definitions[i];if(l.name&&l.name.value==n)return l}}function se(e,n){var i={kind:e.kind,definitions:[R(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var l=V[n]||new Set,v=new Set,m=new Set;for(l.forEach(function(d){m.add(d)});m.size>0;){var u=m;m=new Set,u.forEach(function(d){if(!v.has(d)){v.add(d);var t=V[d]||new Set;t.forEach(function(r){m.add(r)})}})}return v.forEach(function(d){var t=R(e,d);t&&i.definitions.push(t)}),i}se(N,"getBatch");const de={class:"content d-flex flex-column flex-column-fluid",id:"kt_content"},re={class:"container-xxl",id:"kt_content_container"},ce=["onSubmit"],me={class:"d-flex flex-column gap-7 gap-lg-10 w-100 w-lg-300px mb-7 me-lg-10"},ue={class:"card card-flush py-4"},ve=a("div",{class:"card-header"},[a("div",{class:"card-title"},[a("h2",null,"Courses")])],-1),fe={class:"card-body text-center pt-0"},ke={class:"mb-10 fv-row"},pe={class:"card card-flush py-4"},_e=a("div",{class:"card-header"},[a("div",{class:"card-title"},[a("h2",null,"Locations")])],-1),be={class:"card-body text-center pt-0"},he={class:"mb-10 fv-row"},ge={class:"d-flex flex-column flex-row-fluid gap-7 gap-lg-10"},Ne={class:"d-flex flex-column gap-7 gap-lg-10"},ye={class:"card card-flush py-4"},Se=a("div",{class:"card-header"},[a("div",{class:"card-title"},[a("h2",null,"General")])],-1),Ve={class:"card-body pt-0"},we={class:"mb-10 fv-row"},De=a("label",{class:"required form-label"},"Name",-1),xe={class:"mb-10 fv-row"},Fe=a("label",{class:"form-label"},"Commences On",-1),$e={class:"mb-10 fv-row"},Be=a("label",{class:"form-label"},"Completes On",-1),Te={class:"mb-10 fv-row"},Ee=a("label",{class:"form-label"},"Alloted Count",-1),Ce={class:"mb-10 fv-row"},Oe=a("label",{class:"form-label"},"Enrollments Closes On",-1),je={class:"d-flex justify-content-end"},Re=a("span",{class:"indicator-label"},"Save Changes",-1),qe=a("span",{class:"indicator-progress"},[ee("Please wait... "),a("span",{class:"spinner-border spinner-border-sm align-middle ms-2"})],-1),Ue=[Re,qe],We={setup(e){const n=ne();n.title="Update Batch",n.breadcrumbs=[{link:"/dashboard",title:"Dashboard"},{link:"/batches",title:"Batches"},{link:"",title:"Update Batch"}];const i=G(),{result:l,loading:v}=K(N,{slug:i.currentRoute.value.params.slug},{fetchPolicy:"network-only"});let m=p(null),u=p(null),d=p(null),t=T({id:0,name:"",commences_on:null,completes_on:null,enrollments_closes_on:null,alloted_count:0,selected_location:null,selected_course:null,location:{connect:null},course:{connect:null}}),r=T({}),w=p([]),D=p([]);H();const{mutate:q,onDone:Ae,onError:Le}=J(h),U=()=>{if(t.selected_course==null){alert("Course is required!");return}t.selected_course&&(t.course.connect=t.selected_course.id),t.selected_location&&(t.location.connect=t.selected_location.id),d.validate().then(async function(f){if(f=="Valid"){u.value.setAttribute("data-kt-indicator","on"),u.value.disabled=!0;try{const o=await q(B($({},t),{parent_id:t.parent?t.parent.id:null}),{context:{hasUpload:!0}});alert("batch updated successfully"),u.value.removeAttribute("data-kt-indicator"),u.value.disabled=!1}catch{alert("error occurred. please try again later."),u.value.removeAttribute("data-kt-indicator"),u.value.disabled=!1}}else alert("Sorry, looks like there are some errors detected, please try again.")})},A=async()=>{const{data:f,loading:o,fetch:c}=await client.query({query:te},{fetchPolicy:"network-only"});w.value=f.locations.data.map(function(k){return{id:k.id,name:k.name}})},L=async()=>{const{data:f,loading:o,fetch:c}=await client.query({query:le},{fetchPolicy:"network-only"});D.value=f.courses.data.map(function(k){return{id:k.id,name:k.name}})};return W(()=>{l.value&&(l.value.batch?(r=l.value.batch,t.id=r.id,t.name=r.name,t.commences_on=r.commences_on,t.completes_on=r.completes_on,t.enrollments_closes_on=r.enrollments_closes_on,t.alloted_count=r.alloted_count,t.selected_location=r.location==null?null:{id:r.location.id,name:r.location.name},t.selected_course=r.course==null?null:{id:r.course.id,name:r.course.name}):i.push("/batches"))}),X(()=>{d=ie(m.value,{name:{validators:{notEmpty:{message:"Batch Name is required"}}}}),ae.initButtons()}),(f,o)=>(Y(),Z("div",de,[a("div",re,[a("form",{onSubmit:E(U,["prevent"]),ref_key:"form",ref:m,class:"form fv-plugins-bootstrap5 fv-plugins-framework d-flex flex-column flex-lg-row"},[a("div",me,[a("div",ue,[ve,a("div",fe,[a("div",ke,[C(s(O),{modelValue:s(t).selected_course,"onUpdate:modelValue":o[0]||(o[0]=c=>s(t).selected_course=c),onSearchChange:L,"track-by":"id",label:"name","show-labels":!1,multiple:!1,"close-on-select":!0,noOptionsText:"Enter Course",placeholder:"Search a Course",options:s(D)},null,8,["modelValue","options"])])])]),a("div",pe,[_e,a("div",be,[a("div",he,[C(s(O),{modelValue:s(t).selected_location,"onUpdate:modelValue":o[1]||(o[1]=c=>s(t).selected_location=c),onSearchChange:A,"track-by":"id",label:"name","show-labels":!1,multiple:!1,"close-on-select":!0,noOptionsText:"Enter Location",placeholder:"Search a Location",options:s(w)},null,8,["modelValue","options"])])])])]),a("div",ge,[a("div",Ne,[a("div",ye,[Se,a("div",Ve,[a("div",we,[De,_(a("input",{"onUpdate:modelValue":o[2]||(o[2]=c=>s(t).name=c),type:"text",name:"name",class:"form-control mb-2",placeholder:"Batch Name"},null,512),[[b,s(t).name]])]),a("div",xe,[Fe,_(a("input",{"onUpdate:modelValue":o[3]||(o[3]=c=>s(t).commences_on=c),type:"date",name:"commences_on",class:"form-control mb-2",placeholder:"Commencing Date"},null,512),[[b,s(t).commences_on]])]),a("div",$e,[Be,_(a("input",{"onUpdate:modelValue":o[4]||(o[4]=c=>s(t).completes_on=c),type:"date",name:"completes_on",class:"form-control mb-2",placeholder:"Completing Date"},null,512),[[b,s(t).completes_on]])]),a("div",Te,[Ee,_(a("input",{"onUpdate:modelValue":o[5]||(o[5]=c=>s(t).alloted_count=c),type:"number",name:"alloted_count",class:"form-control mb-2",placeholder:"Alloted Students Count"},null,512),[[b,s(t).alloted_count]])]),a("div",Ce,[Oe,_(a("input",{"onUpdate:modelValue":o[6]||(o[6]=c=>s(t).enrollments_closes_on=c),type:"date",name:"enrollments_closes_on",class:"form-control mb-2",placeholder:"Enrollments Closing Date"},null,512),[[b,s(t).enrollments_closes_on]])])])])]),a("div",je,[a("button",{onClick:o[7]||(o[7]=E(c=>s(i).go(-1),["prevent"])),id:"category_create_cancel",class:"btn btn-light me-5"},"Cancel"),a("button",{ref_key:"submitButton",ref:u,type:"submit",id:"submitButton",class:"btn btn-primary"},Ue,512)])])],40,ce)])]))}};export{We as default};
