var Y=Object.defineProperty,H=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var I=(a,i,n)=>i in a?Y(a,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[i]=n,O=(a,i)=>{for(var n in i||(i={}))W.call(i,n)&&I(a,n,i[n]);if(T)for(var n of T(i))X.call(i,n)&&I(a,n,i[n]);return a},R=(a,i)=>H(a,J(i));import{u as Z,U as ee,y as p,N as U,a0 as ae,k as ie,a7 as te,g as ne,r as se,i as le,l as de,m as e,O as q,Y as g,q as s,a8 as B,P as h,Q as oe,n as A,R as N,x as y}from"./vendor.9ac200cc.js";import{u as re,K as ce,a as ue}from"./app.52277fe1.js";import{s as me}from"./vue-multiselect.esm.f7127d48.js";import{v as ve}from"./useValidator.4107c1a7.js";import"./sweetalert2.1b53689f.js";import{C as pe}from"./ckeditor.80e0daed.js";import{d as ge}from"./getCategoriesToSelect.55e6b6b8.js";import"./Bootstrap5.88c59918.js";var w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateCategory"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"description"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"icon"}},type:{kind:"NamedType",name:{kind:"Name",value:"Upload"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"image"}},type:{kind:"NamedType",name:{kind:"Name",value:"Upload"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"status"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"is_featured"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parent_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateCategory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"ObjectField",name:{kind:"Name",value:"description"},value:{kind:"Variable",name:{kind:"Name",value:"description"}}},{kind:"ObjectField",name:{kind:"Name",value:"icon"},value:{kind:"Variable",name:{kind:"Name",value:"icon"}}},{kind:"ObjectField",name:{kind:"Name",value:"image"},value:{kind:"Variable",name:{kind:"Name",value:"image"}}},{kind:"ObjectField",name:{kind:"Name",value:"status"},value:{kind:"Variable",name:{kind:"Name",value:"status"}}},{kind:"ObjectField",name:{kind:"Name",value:"is_featured"},value:{kind:"Variable",name:{kind:"Name",value:"is_featured"}}},{kind:"ObjectField",name:{kind:"Name",value:"parent_id"},value:{kind:"Variable",name:{kind:"Name",value:"parent_id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_featured"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:705}};w.loc.source={body:`mutation updateCategory (\r
    $id: ID!,\r
    $name: String!,\r
    $description: String,\r
    $icon: Upload,\r
    $image: Upload,\r
    $status: Int!,\r
    $is_featured: Int,\r
    $parent_id: ID\r
) {\r
    updateCategory (\r
        id: $id,\r
        input: {\r
            name: $name,\r
            description: $description,\r
            icon: $icon,\r
            image: $image,\r
            status: $status,\r
            is_featured: $is_featured,\r
            parent_id: $parent_id\r
        }\r
    ) {\r
        id\r
        name\r
        description\r
        icon\r
        image\r
        parent {\r
            name\r
            slug\r
        }\r
        status\r
        is_featured\r
        slug\r
    }\r
}\r
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function x(a,i){if(a.kind==="FragmentSpread")i.add(a.name.value);else if(a.kind==="VariableDefinition"){var n=a.type;n.kind==="NamedType"&&i.add(n.name.value)}a.selectionSet&&a.selectionSet.selections.forEach(function(l){x(l,i)}),a.variableDefinitions&&a.variableDefinitions.forEach(function(l){x(l,i)}),a.definitions&&a.definitions.forEach(function(l){x(l,i)})}var D={};(function(){w.definitions.forEach(function(i){if(i.name){var n=new Set;x(i,n),D[i.name.value]=n}})})();function P(a,i){for(var n=0;n<a.definitions.length;n++){var l=a.definitions[n];if(l.name&&l.name.value==i)return l}}function fe(a,i){var n={kind:a.kind,definitions:[P(a,i)]};a.hasOwnProperty("loc")&&(n.loc=a.loc);var l=D[i]||new Set,u=new Set,c=new Set;for(l.forEach(function(r){c.add(r)});c.size>0;){var m=c;c=new Set,m.forEach(function(r){if(!u.has(r)){u.add(r);var t=D[r]||new Set;t.forEach(function(f){c.add(f)})}})}return u.forEach(function(r){var t=P(a,r);t&&n.definitions.push(t)}),n}fe(w,"updateCategory");var S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getCategory"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"slug"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"category"},arguments:[{kind:"Argument",name:{kind:"Name",value:"slug"},value:{kind:"Variable",name:{kind:"Name",value:"slug"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_featured"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:284}};S.loc.source={body:`query getCategory($slug: String!) {\r
    category(slug: $slug) {\r
        id\r
        name\r
        description\r
        icon\r
        image\r
        parent {\r
            id\r
            name\r
            slug\r
        }\r
        status\r
        is_featured\r
        slug\r
    }\r
}\r
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function V(a,i){if(a.kind==="FragmentSpread")i.add(a.name.value);else if(a.kind==="VariableDefinition"){var n=a.type;n.kind==="NamedType"&&i.add(n.name.value)}a.selectionSet&&a.selectionSet.selections.forEach(function(l){V(l,i)}),a.variableDefinitions&&a.variableDefinitions.forEach(function(l){V(l,i)}),a.definitions&&a.definitions.forEach(function(l){V(l,i)})}var $={};(function(){S.definitions.forEach(function(i){if(i.name){var n=new Set;V(i,n),$[i.name.value]=n}})})();function M(a,i){for(var n=0;n<a.definitions.length;n++){var l=a.definitions[n];if(l.name&&l.name.value==i)return l}}function ke(a,i){var n={kind:a.kind,definitions:[M(a,i)]};a.hasOwnProperty("loc")&&(n.loc=a.loc);var l=$[i]||new Set,u=new Set,c=new Set;for(l.forEach(function(r){c.add(r)});c.size>0;){var m=c;c=new Set,m.forEach(function(r){if(!u.has(r)){u.add(r);var t=$[r]||new Set;t.forEach(function(f){c.add(f)})}})}return u.forEach(function(r){var t=M(a,r);t&&n.definitions.push(t)}),n}ke(S,"getCategory");const be={class:"content d-flex flex-column flex-column-fluid",id:"kt_content"},he={class:"container-xxl",id:"kt_content_container"},ye=["onSubmit"],_e={class:"d-flex flex-column gap-7 gap-lg-10 w-100 w-lg-300px mb-7 me-lg-10"},Ne={class:"card card-flush py-4"},we=e("div",{class:"card-header"},[e("div",{class:"card-title"},[e("h2",null,"Icon")])],-1),xe={class:"card-body text-center pt-0"},Se={class:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"change","data-bs-toggle":"tooltip",title:"Change Icon"},Ve=e("i",{class:"bi bi-pencil-fill fs-7"},null,-1),Fe=e("span",{class:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"cancel","data-bs-toggle":"tooltip",title:"Cancel Icon"},[e("i",{class:"bi bi-x fs-2"})],-1),Ce=e("span",{class:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"remove","data-bs-toggle":"tooltip",title:"Remove Icon"},[e("i",{class:"bi bi-x fs-2"})],-1),De=e("div",{class:"text-muted fs-7"},"Set the category icon. Only *.png, *.jpg and *.jpeg image files are accepted",-1),$e={class:"card card-flush py-4"},je=e("div",{class:"card-header"},[e("div",{class:"card-title"},[e("h2",null,"Image")])],-1),Ee={class:"card-body text-center pt-0"},Te={class:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"change","data-bs-toggle":"tooltip",title:"Change Image"},Ie=e("i",{class:"bi bi-pencil-fill fs-7"},null,-1),Oe=e("span",{class:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"cancel","data-bs-toggle":"tooltip",title:"Cancel Image"},[e("i",{class:"bi bi-x fs-2"})],-1),Re=e("span",{class:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"remove","data-bs-toggle":"tooltip",title:"Remove Image"},[e("i",{class:"bi bi-x fs-2"})],-1),Ue=e("div",{class:"text-muted fs-7"},"Set the category image. Only *.png, *.jpg and *.jpeg image files are accepted",-1),qe={class:"d-flex flex-column flex-row-fluid gap-7 gap-lg-10"},Be={class:"d-flex flex-column gap-7 gap-lg-10"},Ae={class:"card card-flush py-4"},Pe=e("div",{class:"card-header"},[e("div",{class:"card-title"},[e("h2",null,"General")])],-1),Me={class:"card-body pt-0"},Qe={class:"mb-10 fv-row"},ze=e("label",{class:"required form-label"},"Category Name",-1),Ge={class:"mb-10 fv-row"},Ke=e("label",{class:"required form-label"},"Parent",-1),Le={class:"mb-10 fv-row"},Ye=e("label",{class:"form-label"},"Description",-1),He={class:"mb-10 fv-row d-flex flex-column"},Je=e("label",{class:"form-label"},"Featured",-1),We={class:"btn-group w-50","data-kt-buttons":"true","data-kt-buttons-target":"[data-kt-button]"},Xe=["checked"],Ze=y(" Yes "),ea=["checked"],aa=y(" No "),ia={class:"mb-10 fv-row d-flex flex-column"},ta=e("label",{class:"form-label"},"Status",-1),na={class:"btn-group w-50","data-kt-buttons":"true","data-kt-buttons-target":"[data-kt-button]"},sa=["checked"],la=y(" Enabled "),da=["checked"],oa=y(" Disabled "),ra={class:"d-flex justify-content-end"},ca=e("span",{class:"indicator-label"},"Save Changes",-1),ua=e("span",{class:"indicator-progress"},[y("Please wait... "),e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"})],-1),ma=[ca,ua],xa={setup(a){const i=re();i.title="Update Category",i.breadcrumbs=[{link:"/dashboard",title:"Dashboard"},{link:"/categories",title:"Categories"},{link:"",title:"Update Category"}];const n=Z(),{result:l,loading:u}=ee(S,{slug:n.currentRoute.value.params.slug},{fetchPolicy:"network-only"});let c=p(null),m=p(null),r=p(null),t=U({id:0,name:"",description:"",image:null,icon:null,status:1,is_featured:0,parent:null}),f=pe,Q={},F=p(null),C=p(null),v=U({}),j=p([]);const{resolveClient:z}=ae(),{mutate:G,onDone:va,onError:pa}=ie(w),K=()=>{r.validate().then(async function(k){if(k=="Valid"){m.value.setAttribute("data-kt-indicator","on"),m.value.disabled=!0;try{const d=await G(R(O({},t),{parent_id:t.parent?t.parent.id:null}),{context:{hasUpload:!0}});alert("category updated successfully"),m.value.removeAttribute("data-kt-indicator"),m.value.disabled=!1}catch{alert("error occurred. please try again later."),m.value.removeAttribute("data-kt-indicator"),m.value.disabled=!1}}else alert("Sorry, looks like there are some errors detected, please try again.")})},_=(k,d,b)=>{if(d=="icon")if(b=="set"){let o=new Blob(C.value.files,{type:"image/*"});o.name=C.value.files[0].name,t.icon=o}else t.icon=null;if(d=="image")if(b=="set"){let o=new Blob(F.value.files,{type:"image/*"});o.name=F.value.files[0].name,t.image=o}else t.image=null};te(()=>{l.value&&(l.value.category?(v=l.value.category,t.id=v.id,t.name=v.name,t.description=v.description,t.status=v.status?1:0,t.is_featured=v.is_featured?1:0,t.parent=v.parent==null?null:{id:v.parent.id,name:v.parent.name}):n.push("/categories"))});const L=async()=>{const k=z(),{data:d,loading:b,fetch:o}=await k.query({query:ge});j.value=d.categories.data.map(function(E){return{id:E.id,name:E.name}})};return ne(()=>{r=ve(c.value,{category_name:{validators:{notEmpty:{message:"Category Name is required"}}},parent:{validators:{notEmpty:{message:"Parent is required"}}}}),ce.init(),ue.initButtons()}),(k,d)=>{const b=se("ckeditor");return le(),de("div",be,[e("div",he,[e("form",{onSubmit:q(K,["prevent"]),ref_key:"form",ref:c,class:"form fv-plugins-bootstrap5 fv-plugins-framework d-flex flex-column flex-lg-row"},[e("div",_e,[e("div",Ne,[we,e("div",xe,[e("div",{class:g([{"image-input-empty":!s(u)&&!s(l).category.icon!=""},"image-input image-input-outline mb-3"]),"data-kt-image-input":"true",style:{"background-image":"url(/media/svg/files/blank-image.svg)"}},[e("div",{class:"image-input-wrapper w-150px h-150px",style:B(s(u)?"":`background-image: url(${s(l).category.icon})`)},null,4),e("label",Se,[Ve,e("input",{ref_key:"icon",ref:C,onChange:d[0]||(d[0]=o=>_(o,"icon","set")),type:"file",name:"icon",accept:".png, .jpg, .jpeg"},null,544),e("input",{type:"hidden",onClick:d[1]||(d[1]=o=>_(o,"icon","remove")),name:"icon_remove"})]),Fe,Ce],2),De])]),e("div",$e,[je,e("div",Ee,[e("div",{class:g([{"image-input-empty":!s(u)&&!s(l).category.image!=""},"image-input image-input-outline mb-3"]),"data-kt-image-input":"true",style:{"background-image":"url(/media/svg/files/blank-image.svg)"}},[e("div",{class:"image-input-wrapper w-150px h-150px",style:B(s(u)?"":`background-image: url(${s(l).category.image})`)},null,4),e("label",Te,[Ie,e("input",{ref_key:"image",ref:F,onChange:d[2]||(d[2]=o=>_(o,"image","set")),type:"file",name:"image",accept:".png, .jpg, .jpeg"},null,544),e("input",{type:"hidden",onClick:d[3]||(d[3]=o=>_(o,"image","remove")),name:"image_remove"})]),Oe,Re],2),Ue])])]),e("div",qe,[e("div",Be,[e("div",Ae,[Pe,e("div",Me,[e("div",Qe,[ze,h(e("input",{"onUpdate:modelValue":d[4]||(d[4]=o=>s(t).name=o),type:"text",name:"category_name",class:"form-control mb-2",placeholder:"Category Name"},null,512),[[oe,s(t).name]])]),e("div",Ge,[Ke,A(s(me),{modelValue:s(t).parent,"onUpdate:modelValue":d[5]||(d[5]=o=>s(t).parent=o),onSearchChange:L,"track-by":"id",label:"name",options:s(j)},null,8,["modelValue","options"])]),e("div",Le,[Ye,A(b,{editor:s(f),modelValue:s(t).description,"onUpdate:modelValue":d[6]||(d[6]=o=>s(t).description=o),config:s(Q)},null,8,["editor","modelValue","config"])]),e("div",He,[Je,e("div",We,[e("label",{class:g(["btn btn-outline-secondary text-muted text-hover-white text-active-white btn-outline btn-active-success",{active:s(t).is_featured==1}]),"data-kt-button":"true"},[h(e("input",{"onUpdate:modelValue":d[7]||(d[7]=o=>s(t).is_featured=o),class:"btn-check",type:"radio",name:"is_featured",checked:s(t).is_featured==1?"checked":"",value:1},null,8,Xe),[[N,s(t).is_featured]]),Ze],2),e("label",{class:g(["btn btn-outline-secondary text-muted text-hover-white text-active-white btn-outline btn-active-danger",{active:s(t).is_featured==0}]),"data-kt-button":"true"},[h(e("input",{"onUpdate:modelValue":d[8]||(d[8]=o=>s(t).is_featured=o),class:"btn-check",type:"radio",name:"is_featured",checked:s(t).is_featured==0?"checked":"",value:0},null,8,ea),[[N,s(t).is_featured]]),aa],2)])]),e("div",ia,[ta,e("div",na,[e("label",{class:g(["btn btn-outline-secondary text-muted text-hover-white text-active-white btn-outline btn-active-success",{active:s(t).status==1}]),"data-kt-button":"true"},[h(e("input",{"onUpdate:modelValue":d[9]||(d[9]=o=>s(t).status=o),class:"btn-check",type:"radio",name:"status",value:1,checked:s(t).status==1?"checked":""},null,8,sa),[[N,s(t).status]]),la],2),e("label",{class:g(["btn btn-outline-secondary text-muted text-hover-white text-active-white btn-outline btn-active-danger",{active:s(t).status==0}]),"data-kt-button":"true"},[h(e("input",{"onUpdate:modelValue":d[10]||(d[10]=o=>s(t).status=o),class:"btn-check",type:"radio",name:"status",value:0,checked:s(t).status==0?"checked":""},null,8,da),[[N,s(t).status]]),oa],2)])])])])]),e("div",ra,[e("button",{onClick:d[11]||(d[11]=q(o=>s(n).go(-1),["prevent"])),id:"category_create_cancel",class:"btn btn-light me-5"},"Cancel"),e("button",{ref_key:"submitButton",ref:m,type:"submit",id:"submitButton",class:"btn btn-primary"},ma,512)])])],40,ye)])])}}};export{xa as default};
